<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Blobstore Fetch Example</title>
    <script>
      function fetchBlobstoreUrlAndShowForm() {
        fetch('/blobstore-upload-url')
          .then((response) => {
            return response.text();
          })
          .then((imageUploadUrl) => {
            const messageForm = document.getElementById('my-form');
            messageForm.action = imageUploadUrl;
            messageForm.classList.remove('hidden');
          });
      }
    </script>
    <style>
      /* Form is hidden by default. */
      .hidden {
        display: none;
      }
    </style>
  </head>
  <body onload="fetchBlobstoreUrlAndShowForm()">
    <h1>Blobstore Fetch Example</h1>
    <p>Type a message and click submit:</p>

    <form id="my-form" class="hidden" method="POST" enctype="multipart/form-data">
      <p>Type some text:</p>
      <textarea name="message"></textarea>
      <br/>
      <p>Upload an image:</p>
      <input type="file" name="image">
      <br/><br/>
      <button>Submit</button>
    </form>
  </body>
</html>